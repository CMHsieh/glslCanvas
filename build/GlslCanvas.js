(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/*
The MIT License (MIT)

Copyright (c) 2015 Patricio Gonzalez Vivo ( http://www.patriciogonzalezvivo.com )

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/

"use strict";

Object.defineProperty(exports, "__esModule", {
	value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var _tools = require("./tools");

var _gl2 = require("./gl");

var GlslCanvas = (function () {
	function GlslCanvas(canvas) {
		_classCallCheck(this, GlslCanvas);

		this.canvas = canvas;
		this.isValid = false;

		var gl = (0, _gl2.setupWebGL)(canvas);
		if (!gl) {
			return;
		}
		this.gl = gl;
		this.timeLoad = Date.now();

		// Load shader
		var fragContent = "";
		if (canvas.hasAttribute("data-fragment")) {
			fragContent = canvas.getAttribute("data-fragment");
		} else if (canvas.hasAttribute("data-fragment-url")) {
			var source = canvas.getAttribute("data-fragment-url");
			fragContent = (0, _tools.fetchHTTP)(source);
		} else {
			console.log("No data");
			return;
		}

		this.load(fragContent);

		if (!this.program) {
			return;
		}

		// Construct VBO
		this.vbo = [];
		if (this.program) {
			// Define UVS buffer
			var uvs = undefined;
			var texCoordLocation = gl.getAttribLocation(this.program, "a_texcoord");
			uvs = gl.createBuffer();
			gl.bindBuffer(gl.ARRAY_BUFFER, uvs);
			gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0]), gl.STATIC_DRAW);
			gl.enableVertexAttribArray(texCoordLocation);
			gl.vertexAttribPointer(texCoordLocation, 2, gl.FLOAT, false, 0, 0);
			this.vbo.push(uvs);

			// Define Vertex buffer
			var vertices = undefined;
			var positionLocation = gl.getAttribLocation(this.program, "a_position");
			vertices = gl.createBuffer();
			this.gl.bindBuffer(gl.ARRAY_BUFFER, vertices);
			this.gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1.0, -1.0, 1.0, -1.0, -1.0, 1.0, -1.0, 1.0, 1.0, -1.0, 1.0, 1.0]), gl.STATIC_DRAW);
			gl.enableVertexAttribArray(positionLocation);
			gl.vertexAttribPointer(positionLocation, 2, gl.FLOAT, false, 0, 0);
			this.vbo.push(vertices);
		}

		// load TEXTURES
		this.textures = [];
		var bLoadTextures = canvas.hasAttribute("data-textures");
		if (bLoadTextures) {
			var imgList = canvas.getAttribute("data-textures").split(",");
			for (var nImg in imgList) {
				console.log("Loading texture: " + imgList[nImg]);

				this.textures.push(gl.createTexture());

				gl.bindTexture(gl.TEXTURE_2D, this.textures[nImg]);
				gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE, new Uint8Array([255, 255, 0, 255])); // red

				this.textures[nImg].image = new Image();
				this.textures[nImg].image.onload = (function (_canvas, _gl, _program, _textures, _tex) {
					return function () {
						(0, _gl2.loadTexture)(_gl, _tex);
						render(_canvas, _gl, _program, _textures);
					};
				})(canvas, gl, shader.program, textures, textures[nImg]);
				textures[nImg].image.src = imgList[nImg];
			}
		}

		this.render({ mouse: { x: 0, y: 0 }, forceRender: true });
	}

	_createClass(GlslCanvas, [{
		key: "load",
		value: function load(fragString, vertString) {

			// Load default vertex shader if no one is pass
			if (!vertString) {
				vertString = "\nprecision mediump float;\nuniform vec2 u_resolution;\nuniform float u_time;\nattribute vec2 a_position;\nattribute vec2 a_texcoord;\nvarying vec2 v_texcoord;\nvoid main() {\n \tgl_Position = vec4(a_position, 0.0, 1.0);\n \tv_texcoord = a_texcoord;\n }";
			}

			// Load default fragment shader if no one is pass
			if (!fragString) {
				fragString += "\nuniform vec2 u_resolution;\nuniform float u_time;\nvarying vec2 v_texcoord;\nvoid main(){\n\tvec2 st = gl_FragCoord.xy/u_resolution;\n\tgl_FragColor = vec4(st.x,st.y,abs(sin(u_time)),1.0);\n}";
			}

			this.vertexString = vertString;
			this.fragmentString = fragString;

			this.animated = false;
			var nTimes = (fragString.match(/u_time/g) || []).length;
			var nMouse = (fragString.match(/u_mouse/g) || []).length;
			this.animated = nTimes > 1 || nMouse > 1;

			var vertexShader = (0, _gl2.createShader)(this.gl, vertString, this.gl.VERTEX_SHADER);
			var fragmentShader = (0, _gl2.createShader)(this.gl, fragString, this.gl.FRAGMENT_SHADER);

			// If Fragment shader fails load a empty one to sign the error
			if (!fragmentShader) {
				fragmentShader = (0, _gl2.createShader)(this.gl, "void main(){\n\tgl_FragColor = vec4(1.0);\n}", this.gl.FRAGMENT_SHADER);
				this.isValid = false;
			} else {
				this.isValid = true;
			}

			// Create and use program
			var program = (0, _gl2.createProgram)(this.gl, [vertexShader, fragmentShader]);
			this.gl.useProgram(program);

			// Delete shaders
			this.gl.detachShader(program, vertexShader);
			this.gl.detachShader(program, fragmentShader);
			this.gl.deleteShader(vertexShader);
			this.gl.deleteShader(fragmentShader);

			this.program = program;
		}
	}, {
		key: "render",
		value: function render(_ref) {
			var forceRender = _ref.forceRender;
			var mouse = _ref.mouse;

			if (forceRender || this.animated && (0, _tools.isCanvasVisible)(this.canvas)) {

				// set the time uniform
				var timeFrame = Date.now();
				var time = (timeFrame - this.timeLoad) / 1000.0;
				var timeLocation = this.gl.getUniformLocation(this.program, "u_time");
				this.gl.uniform1f(timeLocation, time);

				// set the mouse uniform
				var rect = this.canvas.getBoundingClientRect();
				if (mouse && mouse.x >= rect.left && mouse.x <= rect.right && mouse.y >= rect.top && mouse.y <= rect.bottom) {

					var mouseLocation = this.gl.getUniformLocation(this.program, "u_mouse");
					this.gl.uniform2f(mouseLocation, mouse.x - rect.left, this.canvas.height - (mouse.y - rect.top));
				}

				// set the resolution uniform
				var resolutionLocation = this.gl.getUniformLocation(this.program, "u_resolution");
				this.gl.uniform2f(resolutionLocation, this.canvas.width, this.canvas.height);

				for (var i = 0; i < this.textures.length; ++i) {

					this.gl.uniform1i(this.gl.getUniformLocation(this.program, "u_tex" + i), i);
					this.gl.uniform2f(this.gl.getUniformLocation(this.program, "u_tex" + i + "Resolution"), this.textures[i].image.width, this.textures[i].image.height);

					this.gl.activeTexture(this.gl.TEXTURE0 + i);
					this.gl.bindTexture(this.gl.TEXTURE_2D, this.textures[i]);
				}

				// Draw the rectangle.
				this.gl.drawArrays(this.gl.TRIANGLES, 0, 6);
				// console.log("Render " + time);
			}
		}
	}, {
		key: "version",
		value: function version() {
			return "0.0.1";
		}
	}]);

	return GlslCanvas;
})();

exports["default"] = GlslCanvas;
;

window.GlslCanvas = GlslCanvas;
module.exports = exports["default"];

},{"./gl":2,"./tools":3}],2:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
	value: true
});
exports.loadTexture = loadTexture;
exports.setupWebGL = setupWebGL;
exports.create3DContext = create3DContext;
exports.createShader = createShader;
exports.createProgram = createProgram;
var lastError = '';

function loadTexture(_gl, _texture) {
	_gl.bindTexture(_gl.TEXTURE_2D, _texture);
	_gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL, true);
	_gl.texImage2D(_gl.TEXTURE_2D, 0, _gl.RGBA, _gl.RGBA, _gl.UNSIGNED_BYTE, _texture.image);
	if (isPowerOf2(_texture.image.width) && isPowerOf2(_texture.image.height)) {
		_gl.generateMipmap(_gl.TEXTURE_2D);
		_gl.texParameteri(_gl.TEXTURE_2D, _gl.TEXTURE_MAG_FILTER, _gl.LINEAR);
		_gl.texParameteri(_gl.TEXTURE_2D, _gl.TEXTURE_MIN_FILTER, _gl.LINEAR_MIPMAP_LINEAR);
	} else {
		_gl.texParameteri(_gl.TEXTURE_2D, _gl.TEXTURE_WRAP_S, _gl.CLAMP_TO_EDGE);
		_gl.texParameteri(_gl.TEXTURE_2D, _gl.TEXTURE_WRAP_T, _gl.CLAMP_TO_EDGE);
		_gl.texParameteri(_gl.TEXTURE_2D, _gl.TEXTURE_MIN_FILTER, _gl.LINEAR);
	}
	_gl.bindTexture(_gl.TEXTURE_2D, null);
}

/**
 * Creates the HTLM for a failure message
 * @param {string} canvasContainerId id of container of th
 *        canvas.
 * @return {string} The html.
 */
var makeFailHTML = function makeFailHTML(msg) {
	return '' + '<table style="background-color: #8CE; width: 100%; height: 100%;"><tr>' + '<td align="center">' + '<div style="display: table-cell; vertical-align: middle;">' + '<div style="">' + msg + '</div>' + '</div>' + '</td></tr></table>';
};

/**
 * Mesasge for getting a webgl browser
 * @type {string}
 */
var GET_A_WEBGL_BROWSER = '' + 'This page requires a browser that supports WebGL.<br/>' + '<a href="http://get.webgl.org">Click here to upgrade your browser.</a>';

/**
 * Mesasge for need better hardware
 * @type {string}
 */
var OTHER_PROBLEM = '' + 'It doesn\'t appear your computer can support WebGL.<br/>' + '<a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>';

/**
 * Creates a webgl context. If creation fails it will
 * change the contents of the container of the <canvas>
 * tag to an error message with the correct links for WebGL.
 * @param {Element} canvas. The canvas element to create a
 *     context from.
 * @param {WebGLContextCreationAttirbutes} opt_attribs Any
 *     creation attributes you want to pass in.
 * @return {WebGLRenderingContext} The created context.
 */

function setupWebGL(_canvas, _opt_attribs) {

	function showLink(str) {
		var container = _canvas.parentNode;
		if (container) {
			container.innerHTML = makeFailHTML(str);
		}
	};

	if (!window.WebGLRenderingContext) {
		showLink(GET_A_WEBGL_BROWSER);
		return null;
	}

	var context = create3DContext(_canvas, _opt_attribs);
	if (!context) {
		showLink(OTHER_PROBLEM);
	}
	context.getExtension('OES_standard_derivatives');
	return context;
}

;

/**
 * Creates a webgl context.
 * @param {!Canvas} canvas The canvas tag to get context
 *     from. If one is not passed in one will be created.
 * @return {!WebGLContext} The created context.
 */

function create3DContext(_canvas, _opt_attribs) {
	var names = ['webgl', 'experimental-webgl'];
	var context = null;
	for (var ii = 0; ii < names.length; ++ii) {
		try {
			context = _canvas.getContext(names[ii], _opt_attribs);
		} catch (e) {}
		if (context) {
			break;
		}
	}
	return context;
}

/*
 *	Create a Vertex of a specific type (gl.VERTEX_SHADER/)
 */

function createShader(_gl, _source, _type) {
	var shader = _gl.createShader(_type);
	_gl.shaderSource(shader, _source);
	_gl.compileShader(shader);

	var compiled = _gl.getShaderParameter(shader, _gl.COMPILE_STATUS);

	if (!compiled) {
		// Something went wrong during compilation; get the error
		lastError = _gl.getShaderInfoLog(shader);
		console.error('*** Error compiling shader \'' + shader + '\':' + lastError);
		_gl.deleteShader(shader);
		return null;
	}

	return shader;
}

/**
 * Loads a shader.
 * @param {!WebGLContext} gl The WebGLContext to use.
 * @param {string} shaderSource The shader source.
 * @param {number} shaderType The type of shader.
 * @param {function(string): void) opt_errorCallback callback for errors.
 * @return {!WebGLShader} The created shader.
 */

function createProgram(gl, shaders, opt_attribs, opt_locations) {
	var program = gl.createProgram();
	for (var ii = 0; ii < shaders.length; ++ii) {
		gl.attachShader(program, shaders[ii]);
	}
	if (opt_attribs) {
		for (var ii = 0; ii < opt_attribs.length; ++ii) {
			gl.bindAttribLocation(program, opt_locations ? opt_locations[ii] : ii, opt_attribs[ii]);
		}
	}
	gl.linkProgram(program);

	// Check the link status
	var linked = gl.getProgramParameter(program, gl.LINK_STATUS);
	if (!linked) {
		// something went wrong with the link
		lastError = gl.getProgramInfoLog(program);
		console.log('Error in program linking:' + lastError);

		gl.deleteProgram(program);
		return null;
	}
	return program;
}

;

},{}],3:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.isCanvasVisible = isCanvasVisible;
exports.isPowerOf2 = isPowerOf2;
exports.nextHighestPowerOfTwo = nextHighestPowerOfTwo;
exports.fetchHTTP = fetchHTTP;
exports.FormatNumberLength = FormatNumberLength;
exports.getMousePos = getMousePos;

function isCanvasVisible(_canvas) {
	return _canvas.getBoundingClientRect().top + _canvas.height > 0 && _canvas.getBoundingClientRect().top < (window.innerHeight || document.documentElement.clientHeight);
}

;

function isPowerOf2(value) {
	return (value & value - 1) == 0;
}

;

function nextHighestPowerOfTwo(x) {
	--x;
	for (var i = 1; i < 32; i <<= 1) {
		x = x | x >> i;
	}
	return x + 1;
}

;

/*
 *	Fetch for files
 */

function fetchHTTP(url, methood) {
	var request = new XMLHttpRequest(),
	    response;

	request.onreadystatechange = function () {
		if (request.readyState === 4 && request.status === 200) {
			response = request.responseText;
		}
	};
	request.open(methood ? methood : "GET", url, false);
	request.overrideMimeType("text/plain");
	request.send();
	return response;
}

function FormatNumberLength(_num, _length) {
	var r = "" + _num;
	while (r.length < _length) {
		r = "0" + r;
	}
	return r;
}

function getMousePos(_canvas, _evt) {
	var rect = _canvas.getBoundingClientRect();
	return {
		x: _evt.clientX - rect.left,
		y: _evt.clientY - rect.top
	};
}

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvVXNlcnMvcGF0cmljaW8vZ2xzbENhbnZhcy9zcmMvR2xzbENhbnZhcy5qcyIsIi9Vc2Vycy9wYXRyaWNpby9nbHNsQ2FudmFzL3NyYy9nbC5qcyIsIi9Vc2Vycy9wYXRyaWNpby9nbHNsQ2FudmFzL3NyYy90b29scy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztxQkN1QjJDLFNBQVM7O21CQUNpQixNQUFNOztJQUV0RCxVQUFVO0FBQ25CLFVBRFMsVUFBVSxDQUNsQixNQUFNLEVBQUU7d0JBREEsVUFBVTs7QUFHN0IsTUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7QUFDckIsTUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7O0FBRXJCLE1BQUksRUFBRSxHQUFHLFNBUkYsVUFBVSxFQVFHLE1BQU0sQ0FBQyxDQUFDO0FBQzVCLE1BQUksQ0FBQyxFQUFFLEVBQUU7QUFDUixVQUFPO0dBQ1A7QUFDRCxNQUFJLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQztBQUNiLE1BQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDOzs7QUFHM0IsTUFBSSxXQUFXLEdBQUcsRUFBRSxDQUFDO0FBQ3JCLE1BQUksTUFBTSxDQUFDLFlBQVksQ0FBQyxlQUFlLENBQUMsRUFBRTtBQUN6QyxjQUFXLEdBQUcsTUFBTSxDQUFDLFlBQVksQ0FBQyxlQUFlLENBQUMsQ0FBQztHQUNuRCxNQUFNLElBQUksTUFBTSxDQUFDLFlBQVksQ0FBQyxtQkFBbUIsQ0FBQyxFQUFFO0FBQ3BELE9BQUksTUFBTSxHQUFHLE1BQU0sQ0FBQyxZQUFZLENBQUMsbUJBQW1CLENBQUMsQ0FBQztBQUN0RCxjQUFXLEdBQUcsV0F0QlIsU0FBUyxFQXNCUyxNQUFNLENBQUMsQ0FBQztHQUNoQyxNQUFNO0FBQ04sVUFBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUN2QixVQUFPO0dBQ1A7O0FBRUQsTUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQzs7QUFFdkIsTUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUM7QUFDakIsVUFBTTtHQUNOOzs7QUFHRCxNQUFJLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQztBQUNkLE1BQUksSUFBSSxDQUFDLE9BQU8sRUFBRTs7QUFFakIsT0FBSSxHQUFHLFlBQUEsQ0FBQztBQUNSLE9BQUksZ0JBQWdCLEdBQUcsRUFBRSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsWUFBWSxDQUFDLENBQUM7QUFDeEUsTUFBRyxHQUFHLEVBQUUsQ0FBQyxZQUFZLEVBQUUsQ0FBQztBQUN4QixLQUFFLENBQUMsVUFBVSxDQUFFLEVBQUUsQ0FBQyxZQUFZLEVBQUUsR0FBRyxDQUFDLENBQUM7QUFDckMsS0FBRSxDQUFDLFVBQVUsQ0FBRSxFQUFFLENBQUMsWUFBWSxFQUFFLElBQUksWUFBWSxDQUFDLENBQUMsR0FBRyxFQUFHLEdBQUcsRUFDL0MsR0FBRyxFQUFHLEdBQUcsRUFDVCxHQUFHLEVBQUcsR0FBRyxFQUNULEdBQUcsRUFBRyxHQUFHLEVBQ1QsR0FBRyxFQUFHLEdBQUcsRUFDVCxHQUFHLEVBQUcsR0FBRyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDekMsS0FBRSxDQUFDLHVCQUF1QixDQUFFLGdCQUFnQixDQUFFLENBQUM7QUFDL0MsS0FBRSxDQUFDLG1CQUFtQixDQUFFLGdCQUFnQixFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDcEUsT0FBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7OztBQUduQixPQUFJLFFBQVEsWUFBQSxDQUFDO0FBQ2IsT0FBSSxnQkFBZ0IsR0FBRyxFQUFFLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxZQUFZLENBQUMsQ0FBQztBQUN4RSxXQUFRLEdBQUcsRUFBRSxDQUFDLFlBQVksRUFBRSxDQUFDO0FBQzdCLE9BQUksQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFFLEVBQUUsQ0FBQyxZQUFZLEVBQUUsUUFBUSxDQUFDLENBQUM7QUFDL0MsT0FBSSxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUUsRUFBRSxDQUFDLFlBQVksRUFBRSxJQUFJLFlBQVksQ0FBQyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUNyRCxHQUFHLEVBQUUsQ0FBQyxHQUFHLEVBQ1QsQ0FBQyxHQUFHLEVBQUcsR0FBRyxFQUNWLENBQUMsR0FBRyxFQUFHLEdBQUcsRUFDVixHQUFHLEVBQUUsQ0FBQyxHQUFHLEVBQ1QsR0FBRyxFQUFHLEdBQUcsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0FBQ3pDLEtBQUUsQ0FBQyx1QkFBdUIsQ0FBRSxnQkFBZ0IsQ0FBRSxDQUFDO0FBQy9DLEtBQUUsQ0FBQyxtQkFBbUIsQ0FBRSxnQkFBZ0IsRUFBRyxDQUFDLEVBQUUsRUFBRSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQ3JFLE9BQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0dBQ3hCOzs7QUFHRCxNQUFJLENBQUMsUUFBUSxHQUFHLEVBQUUsQ0FBQztBQUNuQixNQUFJLGFBQWEsR0FBRyxNQUFNLENBQUMsWUFBWSxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FBQ3pELE1BQUksYUFBYSxFQUFFO0FBQ2xCLE9BQUksT0FBTyxHQUFHLE1BQU0sQ0FBQyxZQUFZLENBQUMsZUFBZSxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQzlELFFBQUssSUFBSSxJQUFJLElBQUksT0FBTyxFQUFFO0FBQ3pCLFdBQU8sQ0FBQyxHQUFHLENBQUMsbUJBQW1CLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7O0FBRWpELFFBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxhQUFhLEVBQUUsQ0FBQyxDQUFDOztBQUV2QyxNQUFFLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0FBQ25ELE1BQUUsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLFVBQVUsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxhQUFhLEVBQUUsSUFBSSxVQUFVLENBQUMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7O0FBRWpILFFBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxHQUFHLElBQUksS0FBSyxFQUFFLENBQUM7QUFDeEMsUUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUEsVUFBUyxPQUFPLEVBQUMsR0FBRyxFQUFDLFFBQVEsRUFBQyxTQUFTLEVBQUMsSUFBSSxFQUFFO0FBQ2hGLFlBQU8sWUFBVztBQUNqQixlQW5GNEMsV0FBVyxFQW1GM0MsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ3ZCLFlBQU0sQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFLFFBQVEsRUFBRSxTQUFTLENBQUMsQ0FBQTtNQUN6QyxDQUFDO0tBQ0YsQ0FBQSxDQUFDLE1BQU0sRUFBQyxFQUFFLEVBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxRQUFRLEVBQUUsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDcEQsWUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzNDO0dBQ0Q7O0FBRUQsTUFBSSxDQUFDLE1BQU0sQ0FBRSxFQUFFLEtBQUssRUFBRSxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBQyxFQUFFLFdBQVcsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0VBQ3pEOztjQTFGbUIsVUFBVTs7U0E0RjFCLGNBQUUsVUFBVSxFQUFFLFVBQVUsRUFBRzs7O0FBRzlCLE9BQUksQ0FBQyxVQUFVLEVBQUU7QUFDaEIsY0FBVSxHQUFHLCtQQVViLENBQUM7SUFDRDs7O0FBR0QsT0FBSSxDQUFDLFVBQVUsRUFBRTtBQUNoQixjQUFVLElBQUksbU1BT2YsQ0FBQztJQUNBOztBQUVELE9BQUksQ0FBQyxZQUFZLEdBQUcsVUFBVSxDQUFDO0FBQy9CLE9BQUksQ0FBQyxjQUFjLEdBQUcsVUFBVSxDQUFDOztBQUVqQyxPQUFJLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQztBQUN0QixPQUFJLE1BQU0sR0FBRyxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLElBQUksRUFBRSxDQUFBLENBQUUsTUFBTSxDQUFDO0FBQ3hELE9BQUksTUFBTSxHQUFHLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUEsQ0FBRSxNQUFNLENBQUM7QUFDekQsT0FBSSxDQUFDLFFBQVEsR0FBRyxNQUFNLEdBQUcsQ0FBQyxJQUFJLE1BQU0sR0FBRyxDQUFDLENBQUM7O0FBRXpDLE9BQUksWUFBWSxHQUFHLFNBbklBLFlBQVksRUFtSUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxhQUFhLENBQUMsQ0FBQztBQUM1RSxPQUFJLGNBQWMsR0FBRyxTQXBJRixZQUFZLEVBb0lHLElBQUksQ0FBQyxFQUFFLEVBQUUsVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsZUFBZSxDQUFDLENBQUM7OztBQUdoRixPQUFJLENBQUMsY0FBYyxFQUFFO0FBQ3BCLGtCQUFjLEdBQUcsU0F4SUMsWUFBWSxFQXdJQSxJQUFJLENBQUMsRUFBRSxFQUFFLDhDQUE4QyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsZUFBZSxDQUFDLENBQUM7QUFDaEgsUUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7SUFDckIsTUFBTTtBQUNOLFFBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDO0lBQ3BCOzs7QUFHRCxPQUFJLE9BQU8sR0FBRyxTQS9JbUIsYUFBYSxFQStJbEIsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLFlBQVksRUFBRSxjQUFjLENBQUMsQ0FBQyxDQUFDO0FBQ3JFLE9BQUksQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDOzs7QUFHNUIsT0FBSSxDQUFDLEVBQUUsQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFFLFlBQVksQ0FBQyxDQUFDO0FBQzVDLE9BQUksQ0FBQyxFQUFFLENBQUMsWUFBWSxDQUFDLE9BQU8sRUFBRSxjQUFjLENBQUMsQ0FBQztBQUM5QyxPQUFJLENBQUMsRUFBRSxDQUFDLFlBQVksQ0FBQyxZQUFZLENBQUMsQ0FBQztBQUNuQyxPQUFJLENBQUMsRUFBRSxDQUFDLFlBQVksQ0FBQyxjQUFjLENBQUMsQ0FBQzs7QUFFckMsT0FBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7R0FDdkI7OztTQUVLLGdCQUFDLElBQXNCLEVBQUU7T0FBdEIsV0FBVyxHQUFiLElBQXNCLENBQXBCLFdBQVc7T0FBRSxLQUFLLEdBQXBCLElBQXNCLENBQVAsS0FBSzs7QUFFMUIsT0FBSSxXQUFXLElBQUssSUFBSSxDQUFDLFFBQVEsSUFBSSxXQTlKbkIsZUFBZSxFQThKb0IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFHOzs7QUFHbkUsUUFBSSxTQUFTLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO0FBQzNCLFFBQUksSUFBSSxHQUFHLENBQUMsU0FBUyxHQUFDLElBQUksQ0FBQyxRQUFRLENBQUEsR0FBSSxNQUFNLENBQUM7QUFDOUMsUUFBSSxZQUFZLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0FBQ3RFLFFBQUksQ0FBQyxFQUFFLENBQUMsU0FBUyxDQUFDLFlBQVksRUFBRSxJQUFJLENBQUMsQ0FBQzs7O0FBR3RDLFFBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMscUJBQXFCLEVBQUUsQ0FBQztBQUMvQyxRQUFJLEtBQUssSUFDUixLQUFLLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxJQUFJLElBQ3BCLEtBQUssQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLEtBQUssSUFDckIsS0FBSyxDQUFDLENBQUMsSUFBSSxJQUFJLENBQUMsR0FBRyxJQUNuQixLQUFLLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUU7O0FBRXhCLFNBQUksYUFBYSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxTQUFTLENBQUMsQ0FBQztBQUN4RSxTQUFJLENBQUMsRUFBRSxDQUFDLFNBQVMsQ0FBQyxhQUFhLEVBQUMsS0FBSyxDQUFDLENBQUMsR0FBQyxJQUFJLENBQUMsSUFBSSxFQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxJQUFFLEtBQUssQ0FBQyxDQUFDLEdBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQSxDQUFFLENBQUM7S0FDekY7OztBQUdELFFBQUksa0JBQWtCLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLGNBQWMsQ0FBQyxDQUFDO0FBQ2xGLFFBQUksQ0FBQyxFQUFFLENBQUMsU0FBUyxDQUFDLGtCQUFrQixFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7O0FBRTdFLFNBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsRUFBQzs7QUFFN0MsU0FBSSxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBRSxJQUFJLENBQUMsT0FBTyxFQUFFLE9BQU8sR0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztBQUM1RSxTQUFJLENBQUMsRUFBRSxDQUFDLFNBQVMsQ0FBRSxJQUFJLENBQUMsRUFBRSxDQUFDLGtCQUFrQixDQUFFLElBQUksQ0FBQyxPQUFPLEVBQUUsT0FBTyxHQUFDLENBQUMsR0FBQyxZQUFZLENBQUMsRUFDN0UsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUM1QixJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQzs7QUFFdEMsU0FBSSxDQUFDLEVBQUUsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxRQUFRLEdBQUMsQ0FBQyxDQUFDLENBQUM7QUFDMUMsU0FBSSxDQUFDLEVBQUUsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBRTFEOzs7QUFHRCxRQUFJLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7O0lBRTVDO0dBQ0Q7OztTQUVNLG1CQUFHO0FBQ1QsVUFBTyxPQUFPLENBQUM7R0FDZjs7O1FBdk1tQixVQUFVOzs7cUJBQVYsVUFBVTtBQXdNOUIsQ0FBQzs7QUFFRixNQUFNLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQzs7Ozs7Ozs7O1FDbE9mLFdBQVcsR0FBWCxXQUFXO1FBMERYLFVBQVUsR0FBVixVQUFVO1FBNEJWLGVBQWUsR0FBZixlQUFlO1FBaUJmLFlBQVksR0FBWixZQUFZO1FBMEJaLGFBQWEsR0FBYixhQUFhO0FBbkk3QixJQUFJLFNBQVMsR0FBRyxFQUFFLENBQUM7O0FBRVosU0FBUyxXQUFXLENBQUMsR0FBRyxFQUFFLFFBQVEsRUFBRTtBQUMxQyxJQUFHLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUM7QUFDMUMsSUFBRyxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsbUJBQW1CLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDL0MsSUFBRyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLENBQUMsRUFBRSxHQUFHLENBQUMsSUFBSSxFQUFFLEdBQUcsQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLGFBQWEsRUFBRSxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDekYsS0FBSSxVQUFVLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsSUFBSSxVQUFVLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFBRztBQUMzRSxLQUFHLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUNuQyxLQUFHLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxVQUFVLEVBQUUsR0FBRyxDQUFDLGtCQUFrQixFQUFFLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUN0RSxLQUFHLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxVQUFVLEVBQUUsR0FBRyxDQUFDLGtCQUFrQixFQUFFLEdBQUcsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0VBQ3BGLE1BQU07QUFDTixLQUFHLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxVQUFVLEVBQUUsR0FBRyxDQUFDLGNBQWMsRUFBRSxHQUFHLENBQUMsYUFBYSxDQUFDLENBQUM7QUFDekUsS0FBRyxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLEdBQUcsQ0FBQyxjQUFjLEVBQUUsR0FBRyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0FBQ3pFLEtBQUcsQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBRSxHQUFHLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0VBQ3RFO0FBQ0QsSUFBRyxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFDO0NBQ3RDOzs7Ozs7OztBQVFELElBQUksWUFBWSxHQUFHLFNBQWYsWUFBWSxDQUFZLEdBQUcsRUFBRTtBQUMvQixRQUFPLEVBQUUsR0FDVCx3RUFBd0UsR0FDeEUscUJBQXFCLEdBQ3JCLDREQUE0RCxHQUM1RCxnQkFBZ0IsR0FBRyxHQUFHLEdBQUcsUUFBUSxHQUNqQyxRQUFRLEdBQ1Isb0JBQW9CLENBQUM7Q0FDdEIsQ0FBQzs7Ozs7O0FBTUYsSUFBSSxtQkFBbUIsR0FBRyxFQUFFLEdBQzNCLHdEQUF3RCxHQUN4RCx3RUFBd0UsQ0FBQzs7Ozs7O0FBTTFFLElBQUksYUFBYSxHQUFHLEVBQUUsR0FDckIsMERBQXlELEdBQ3pELHNGQUFzRixDQUFDOzs7Ozs7Ozs7Ozs7O0FBWWpGLFNBQVMsVUFBVSxDQUFFLE9BQU8sRUFBRSxZQUFZLEVBQUU7O0FBRWxELFVBQVMsUUFBUSxDQUFDLEdBQUcsRUFBRTtBQUN0QixNQUFJLFNBQVMsR0FBRyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQ25DLE1BQUksU0FBUyxFQUFFO0FBQ2IsWUFBUyxDQUFDLFNBQVMsR0FBRyxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUM7R0FDekM7RUFDRCxDQUFDOztBQUVGLEtBQUksQ0FBQyxNQUFNLENBQUMscUJBQXFCLEVBQUU7QUFDbEMsVUFBUSxDQUFDLG1CQUFtQixDQUFDLENBQUM7QUFDOUIsU0FBTyxJQUFJLENBQUM7RUFDWjs7QUFFRCxLQUFJLE9BQU8sR0FBRyxlQUFlLENBQUMsT0FBTyxFQUFFLFlBQVksQ0FBQyxDQUFDO0FBQ3JELEtBQUksQ0FBQyxPQUFPLEVBQUU7QUFDYixVQUFRLENBQUMsYUFBYSxDQUFDLENBQUM7RUFDeEI7QUFDRCxRQUFPLENBQUMsWUFBWSxDQUFDLDBCQUEwQixDQUFDLENBQUM7QUFDakQsUUFBTyxPQUFPLENBQUM7Q0FDZjs7QUFBQSxDQUFDOzs7Ozs7Ozs7QUFRSyxTQUFTLGVBQWUsQ0FBQyxPQUFPLEVBQUUsWUFBWSxFQUFFO0FBQ3RELEtBQUksS0FBSyxHQUFHLENBQUMsT0FBTyxFQUFFLG9CQUFvQixDQUFDLENBQUM7QUFDNUMsS0FBSSxPQUFPLEdBQUcsSUFBSSxDQUFDO0FBQ25CLE1BQUssSUFBSSxFQUFFLEdBQUcsQ0FBQyxFQUFFLEVBQUUsR0FBRyxLQUFLLENBQUMsTUFBTSxFQUFFLEVBQUUsRUFBRSxFQUFFO0FBQ3pDLE1BQUk7QUFDRCxVQUFPLEdBQUcsT0FBTyxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUUsWUFBWSxDQUFDLENBQUM7R0FDeEQsQ0FBQyxPQUFNLENBQUMsRUFBRSxFQUFFO0FBQ1osTUFBSSxPQUFPLEVBQUU7QUFDVixTQUFNO0dBQ1Q7RUFDRDtBQUNELFFBQU8sT0FBTyxDQUFDO0NBQ2Y7Ozs7OztBQUtNLFNBQVMsWUFBWSxDQUFDLEdBQUcsRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFO0FBQ2pELEtBQUksTUFBTSxHQUFHLEdBQUcsQ0FBQyxZQUFZLENBQUUsS0FBSyxDQUFFLENBQUM7QUFDdkMsSUFBRyxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDbEMsSUFBRyxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQzs7QUFFMUIsS0FBSSxRQUFRLEdBQUcsR0FBRyxDQUFDLGtCQUFrQixDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsY0FBYyxDQUFDLENBQUM7O0FBRWxFLEtBQUksQ0FBQyxRQUFRLEVBQUU7O0FBRWQsV0FBUyxHQUFHLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUN6QyxTQUFPLENBQUMsS0FBSyxDQUFDLCtCQUE4QixHQUFHLE1BQU0sR0FBRyxLQUFJLEdBQUcsU0FBUyxDQUFDLENBQUM7QUFDMUUsS0FBRyxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUN6QixTQUFPLElBQUksQ0FBQztFQUNaOztBQUVELFFBQU8sTUFBTSxDQUFDO0NBQ2Q7Ozs7Ozs7Ozs7O0FBVU0sU0FBUyxhQUFhLENBQUMsRUFBRSxFQUFFLE9BQU8sRUFBRSxXQUFXLEVBQUUsYUFBYSxFQUFFO0FBQ3RFLEtBQUksT0FBTyxHQUFHLEVBQUUsQ0FBQyxhQUFhLEVBQUUsQ0FBQztBQUNqQyxNQUFLLElBQUksRUFBRSxHQUFHLENBQUMsRUFBRSxFQUFFLEdBQUcsT0FBTyxDQUFDLE1BQU0sRUFBRSxFQUFFLEVBQUUsRUFBRTtBQUMzQyxJQUFFLENBQUMsWUFBWSxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztFQUN0QztBQUNELEtBQUksV0FBVyxFQUFFO0FBQ2hCLE9BQUssSUFBSSxFQUFFLEdBQUcsQ0FBQyxFQUFFLEVBQUUsR0FBRyxXQUFXLENBQUMsTUFBTSxFQUFFLEVBQUUsRUFBRSxFQUFFO0FBQzdDLEtBQUUsQ0FBQyxrQkFBa0IsQ0FDckIsT0FBTyxFQUNQLGFBQWEsR0FBRyxhQUFhLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxFQUN0QyxXQUFXLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztHQUNuQjtFQUNEO0FBQ0QsR0FBRSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQzs7O0FBR3hCLEtBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQyxtQkFBbUIsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0FBQzdELEtBQUksQ0FBQyxNQUFNLEVBQUU7O0FBRVosV0FBUyxHQUFHLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBRSxPQUFPLENBQUMsQ0FBQztBQUMzQyxTQUFPLENBQUMsR0FBRyxDQUFDLDJCQUEyQixHQUFHLFNBQVMsQ0FBQyxDQUFDOztBQUVyRCxJQUFFLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQzFCLFNBQU8sSUFBSSxDQUFDO0VBQ1o7QUFDRCxRQUFPLE9BQU8sQ0FBQztDQUNmOztBQUFBLENBQUM7Ozs7Ozs7O1FDN0pjLGVBQWUsR0FBZixlQUFlO1FBS2YsVUFBVSxHQUFWLFVBQVU7UUFJVixxQkFBcUIsR0FBckIscUJBQXFCO1FBV3JCLFNBQVMsR0FBVCxTQUFTO1FBY1Qsa0JBQWtCLEdBQWxCLGtCQUFrQjtRQVFsQixXQUFXLEdBQVgsV0FBVzs7QUExQ3BCLFNBQVMsZUFBZSxDQUFDLE9BQU8sRUFBQztBQUN2QyxRQUFPLE9BQVMsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDLEdBQUcsR0FBRyxPQUFPLENBQUMsTUFBTSxHQUFJLENBQUMsSUFDL0QsT0FBTyxDQUFDLHFCQUFxQixFQUFFLENBQUMsR0FBRyxJQUFJLE1BQU0sQ0FBQyxXQUFXLElBQUksUUFBUSxDQUFDLGVBQWUsQ0FBQyxZQUFZLENBQUEsQ0FBRztDQUN4Rzs7QUFBQSxDQUFDOztBQUVLLFNBQVMsVUFBVSxDQUFDLEtBQUssRUFBRTtBQUNoQyxRQUFPLENBQUMsS0FBSyxHQUFJLEtBQUssR0FBRyxDQUFDLENBQUMsSUFBSyxDQUFDLENBQUM7Q0FDbkM7O0FBQUEsQ0FBQzs7QUFFSyxTQUFTLHFCQUFxQixDQUFDLENBQUMsRUFBRTtBQUNyQyxHQUFFLENBQUMsQ0FBQztBQUNKLE1BQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsRUFBRTtBQUM3QixHQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7RUFDbEI7QUFDRCxRQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7Q0FDaEI7O0FBQUEsQ0FBQzs7Ozs7O0FBS0ssU0FBUyxTQUFTLENBQUMsR0FBRyxFQUFFLE9BQU8sRUFBQztBQUN0QyxLQUFJLE9BQU8sR0FBRyxJQUFJLGNBQWMsRUFBRTtLQUFFLFFBQVEsQ0FBQzs7QUFFN0MsUUFBTyxDQUFDLGtCQUFrQixHQUFHLFlBQVk7QUFDeEMsTUFBSSxPQUFPLENBQUMsVUFBVSxLQUFLLENBQUMsSUFBSSxPQUFPLENBQUMsTUFBTSxLQUFLLEdBQUcsRUFBRTtBQUN2RCxXQUFRLEdBQUcsT0FBTyxDQUFDLFlBQVksQ0FBQztHQUNoQztFQUNELENBQUE7QUFDRCxRQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLEdBQUcsS0FBSyxFQUFFLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQztBQUNwRCxRQUFPLENBQUMsZ0JBQWdCLENBQUMsWUFBWSxDQUFDLENBQUM7QUFDdkMsUUFBTyxDQUFDLElBQUksRUFBRSxDQUFDO0FBQ2YsUUFBTyxRQUFRLENBQUM7Q0FDaEI7O0FBRU0sU0FBUyxrQkFBa0IsQ0FBQyxJQUFJLEVBQUUsT0FBTyxFQUFFO0FBQzlDLEtBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUM7QUFDbEIsUUFBTyxDQUFDLENBQUMsTUFBTSxHQUFHLE9BQU8sRUFBRTtBQUN2QixHQUFDLEdBQUcsR0FBRyxHQUFHLENBQUMsQ0FBQztFQUNmO0FBQ0QsUUFBTyxDQUFDLENBQUM7Q0FDWjs7QUFFTSxTQUFTLFdBQVcsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFO0FBQzFDLEtBQUksSUFBSSxHQUFHLE9BQU8sQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO0FBQzNDLFFBQU87QUFDTixHQUFDLEVBQUUsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsSUFBSTtBQUMzQixHQUFDLEVBQUUsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsR0FBRztFQUMxQixDQUFDO0NBQ0YiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLypcblRoZSBNSVQgTGljZW5zZSAoTUlUKVxuXG5Db3B5cmlnaHQgKGMpIDIwMTUgUGF0cmljaW8gR29uemFsZXogVml2byAoIGh0dHA6Ly93d3cucGF0cmljaW9nb256YWxlenZpdm8uY29tIClcblxuUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZlxudGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpblxudGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0b1xudXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2ZcbnRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbyxcbnN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuXG5UaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGxcbmNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG5cblRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbklNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTXG5GT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1JcbkNPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUlxuSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU5cbkNPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG4qL1xuXG5pbXBvcnQgeyBmZXRjaEhUVFAsIGlzQ2FudmFzVmlzaWJsZSB9IGZyb20gXCIuL3Rvb2xzXCJcbmltcG9ydCB7IHNldHVwV2ViR0wsIGNyZWF0ZVNoYWRlciwgY3JlYXRlUHJvZ3JhbSwgbG9hZFRleHR1cmUgfSBmcm9tIFwiLi9nbFwiXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdsc2xDYW52YXMge1xuXHRjb25zdHJ1Y3RvcihjYW52YXMpIHtcblxuXHRcdHRoaXMuY2FudmFzID0gY2FudmFzO1xuXHRcdHRoaXMuaXNWYWxpZCA9IGZhbHNlO1xuXG5cdFx0bGV0IGdsID0gc2V0dXBXZWJHTChjYW52YXMpO1xuXHRcdGlmICghZ2wpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0dGhpcy5nbCA9IGdsO1xuXHRcdHRoaXMudGltZUxvYWQgPSBEYXRlLm5vdygpO1xuXG5cdFx0Ly8gTG9hZCBzaGFkZXJcblx0XHRsZXQgZnJhZ0NvbnRlbnQgPSBcIlwiO1xuXHRcdGlmIChjYW52YXMuaGFzQXR0cmlidXRlKFwiZGF0YS1mcmFnbWVudFwiKSkge1xuXHRcdFx0ZnJhZ0NvbnRlbnQgPSBjYW52YXMuZ2V0QXR0cmlidXRlKCdkYXRhLWZyYWdtZW50Jyk7XG5cdFx0fSBlbHNlIGlmIChjYW52YXMuaGFzQXR0cmlidXRlKFwiZGF0YS1mcmFnbWVudC11cmxcIikpIHtcblx0XHRcdGxldCBzb3VyY2UgPSBjYW52YXMuZ2V0QXR0cmlidXRlKCdkYXRhLWZyYWdtZW50LXVybCcpO1xuXHRcdFx0ZnJhZ0NvbnRlbnQgPSBmZXRjaEhUVFAoc291cmNlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS5sb2coXCJObyBkYXRhXCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMubG9hZChmcmFnQ29udGVudCk7XG5cblx0XHRpZiAoIXRoaXMucHJvZ3JhbSl7XG5cdFx0XHRyZXR1cm5cblx0XHR9XG5cblx0XHQvLyBDb25zdHJ1Y3QgVkJPXG5cdFx0dGhpcy52Ym8gPSBbXTtcblx0XHRpZiAodGhpcy5wcm9ncmFtKSB7XG5cdFx0XHQvLyBEZWZpbmUgVVZTIGJ1ZmZlclxuXHRcdFx0bGV0IHV2cztcblx0XHRcdGxldCB0ZXhDb29yZExvY2F0aW9uID0gZ2wuZ2V0QXR0cmliTG9jYXRpb24odGhpcy5wcm9ncmFtLCBcImFfdGV4Y29vcmRcIik7XG5cdFx0XHR1dnMgPSBnbC5jcmVhdGVCdWZmZXIoKTtcblx0XHRcdGdsLmJpbmRCdWZmZXIoIGdsLkFSUkFZX0JVRkZFUiwgdXZzKTtcblx0XHRcdGdsLmJ1ZmZlckRhdGEoIGdsLkFSUkFZX0JVRkZFUiwgbmV3IEZsb2F0MzJBcnJheShbMC4wLCAgMC4wLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0MS4wLCAgMC4wLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0MC4wLCAgMS4wLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0MC4wLCAgMS4wLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0MS4wLCAgMC4wLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0MS4wLCAgMS4wXSksIGdsLlNUQVRJQ19EUkFXKTtcblx0XHRcdGdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KCB0ZXhDb29yZExvY2F0aW9uICk7XG5cdFx0XHRnbC52ZXJ0ZXhBdHRyaWJQb2ludGVyKCB0ZXhDb29yZExvY2F0aW9uLCAyLCBnbC5GTE9BVCwgZmFsc2UsIDAsIDApO1xuXHRcdFx0dGhpcy52Ym8ucHVzaCh1dnMpO1xuXHRcdFx0XG5cdFx0XHQvLyBEZWZpbmUgVmVydGV4IGJ1ZmZlclxuXHRcdFx0bGV0IHZlcnRpY2VzO1xuXHRcdFx0bGV0IHBvc2l0aW9uTG9jYXRpb24gPSBnbC5nZXRBdHRyaWJMb2NhdGlvbih0aGlzLnByb2dyYW0sIFwiYV9wb3NpdGlvblwiKTtcblx0XHRcdHZlcnRpY2VzID0gZ2wuY3JlYXRlQnVmZmVyKCk7XG5cdFx0XHR0aGlzLmdsLmJpbmRCdWZmZXIoIGdsLkFSUkFZX0JVRkZFUiwgdmVydGljZXMpO1xuXHRcdFx0dGhpcy5nbC5idWZmZXJEYXRhKCBnbC5BUlJBWV9CVUZGRVIsIG5ldyBGbG9hdDMyQXJyYXkoWy0xLjAsIC0xLjAsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQxLjAsIC0xLjAsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQtMS4wLCAgMS4wLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0LTEuMCwgIDEuMCxcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdDEuMCwgLTEuMCxcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdDEuMCwgIDEuMF0pLCBnbC5TVEFUSUNfRFJBVyk7XG5cdFx0XHRnbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheSggcG9zaXRpb25Mb2NhdGlvbiApO1xuXHRcdFx0Z2wudmVydGV4QXR0cmliUG9pbnRlciggcG9zaXRpb25Mb2NhdGlvbiAsIDIsIGdsLkZMT0FULCBmYWxzZSwgMCwgMCk7XG5cdFx0XHR0aGlzLnZiby5wdXNoKHZlcnRpY2VzKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gbG9hZCBURVhUVVJFU1xuXHRcdHRoaXMudGV4dHVyZXMgPSBbXTtcblx0XHRsZXQgYkxvYWRUZXh0dXJlcyA9IGNhbnZhcy5oYXNBdHRyaWJ1dGUoJ2RhdGEtdGV4dHVyZXMnKTtcblx0XHRpZiAoYkxvYWRUZXh0dXJlcykge1xuXHRcdFx0bGV0IGltZ0xpc3QgPSBjYW52YXMuZ2V0QXR0cmlidXRlKCdkYXRhLXRleHR1cmVzJykuc3BsaXQoJywnKTtcblx0XHRcdGZvciAobGV0IG5JbWcgaW4gaW1nTGlzdCkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcIkxvYWRpbmcgdGV4dHVyZTogXCIgKyBpbWdMaXN0W25JbWddKTtcblxuXHRcdFx0XHR0aGlzLnRleHR1cmVzLnB1c2goZ2wuY3JlYXRlVGV4dHVyZSgpKTtcblxuXHRcdFx0XHRnbC5iaW5kVGV4dHVyZShnbC5URVhUVVJFXzJELCB0aGlzLnRleHR1cmVzW25JbWddKTtcblx0XHRcdFx0Z2wudGV4SW1hZ2UyRChnbC5URVhUVVJFXzJELCAwLCBnbC5SR0JBLCAxLCAxLCAwLCBnbC5SR0JBLCBnbC5VTlNJR05FRF9CWVRFLCBuZXcgVWludDhBcnJheShbMjU1LCAyNTUsIDAsIDI1NV0pKTsgLy8gcmVkXG5cblx0XHRcdFx0dGhpcy50ZXh0dXJlc1tuSW1nXS5pbWFnZSA9IG5ldyBJbWFnZSgpO1xuXHRcdFx0XHR0aGlzLnRleHR1cmVzW25JbWddLmltYWdlLm9ubG9hZCA9IGZ1bmN0aW9uKF9jYW52YXMsX2dsLF9wcm9ncmFtLF90ZXh0dXJlcyxfdGV4KSB7IFxuXHRcdFx0XHRcdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdGxvYWRUZXh0dXJlKF9nbCwgX3RleCk7IFxuXHRcdFx0XHRcdFx0cmVuZGVyKF9jYW52YXMsIF9nbCwgX3Byb2dyYW0sIF90ZXh0dXJlcylcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9KGNhbnZhcyxnbCxzaGFkZXIucHJvZ3JhbSwgdGV4dHVyZXMsIHRleHR1cmVzW25JbWddKTtcblx0ICBcdFx0XHR0ZXh0dXJlc1tuSW1nXS5pbWFnZS5zcmMgPSBpbWdMaXN0W25JbWddO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMucmVuZGVyKCB7IG1vdXNlOiB7eDogMCwgeTogMH0sIGZvcmNlUmVuZGVyOiB0cnVlIH0pO1xuXHR9XG5cblx0bG9hZCggZnJhZ1N0cmluZywgdmVydFN0cmluZyApIHtcblxuXHRcdC8vIExvYWQgZGVmYXVsdCB2ZXJ0ZXggc2hhZGVyIGlmIG5vIG9uZSBpcyBwYXNzXG5cdFx0aWYgKCF2ZXJ0U3RyaW5nKSB7XG5cdFx0XHR2ZXJ0U3RyaW5nID0gXCJcXG5cXFxucHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7XFxuXFxcbnVuaWZvcm0gdmVjMiB1X3Jlc29sdXRpb247XFxuXFxcbnVuaWZvcm0gZmxvYXQgdV90aW1lO1xcblxcXG5hdHRyaWJ1dGUgdmVjMiBhX3Bvc2l0aW9uO1xcblxcXG5hdHRyaWJ1dGUgdmVjMiBhX3RleGNvb3JkO1xcblxcXG52YXJ5aW5nIHZlYzIgdl90ZXhjb29yZDtcXG5cXFxudm9pZCBtYWluKCkge1xcblxcXG4gXHRnbF9Qb3NpdGlvbiA9IHZlYzQoYV9wb3NpdGlvbiwgMC4wLCAxLjApO1xcblxcXG4gXHR2X3RleGNvb3JkID0gYV90ZXhjb29yZDtcXG5cXFxuIH1cIjtcblx0XHR9XG5cblx0XHQvLyBMb2FkIGRlZmF1bHQgZnJhZ21lbnQgc2hhZGVyIGlmIG5vIG9uZSBpcyBwYXNzXG5cdFx0aWYgKCFmcmFnU3RyaW5nKSB7XG5cdFx0XHRmcmFnU3RyaW5nICs9IFwiXFxuXFxcbnVuaWZvcm0gdmVjMiB1X3Jlc29sdXRpb247XFxuXFxcbnVuaWZvcm0gZmxvYXQgdV90aW1lO1xcblxcXG52YXJ5aW5nIHZlYzIgdl90ZXhjb29yZDtcXG5cXFxudm9pZCBtYWluKCl7XFxuXFxcblx0dmVjMiBzdCA9IGdsX0ZyYWdDb29yZC54eS91X3Jlc29sdXRpb247XFxuXFxcblx0Z2xfRnJhZ0NvbG9yID0gdmVjNChzdC54LHN0LnksYWJzKHNpbih1X3RpbWUpKSwxLjApO1xcblxcXG59XCI7XG5cdFx0fVxuXG5cdFx0dGhpcy52ZXJ0ZXhTdHJpbmcgPSB2ZXJ0U3RyaW5nO1xuXHRcdHRoaXMuZnJhZ21lbnRTdHJpbmcgPSBmcmFnU3RyaW5nO1xuXG5cdFx0dGhpcy5hbmltYXRlZCA9IGZhbHNlO1xuXHRcdGxldCBuVGltZXMgPSAoZnJhZ1N0cmluZy5tYXRjaCgvdV90aW1lL2cpIHx8IFtdKS5sZW5ndGg7XG5cdFx0bGV0IG5Nb3VzZSA9IChmcmFnU3RyaW5nLm1hdGNoKC91X21vdXNlL2cpIHx8IFtdKS5sZW5ndGg7XG5cdFx0dGhpcy5hbmltYXRlZCA9IG5UaW1lcyA+IDEgfHwgbk1vdXNlID4gMTtcblxuXHRcdGxldCB2ZXJ0ZXhTaGFkZXIgPSBjcmVhdGVTaGFkZXIodGhpcy5nbCwgdmVydFN0cmluZywgdGhpcy5nbC5WRVJURVhfU0hBREVSKTtcblx0XHRsZXQgZnJhZ21lbnRTaGFkZXIgPSBjcmVhdGVTaGFkZXIodGhpcy5nbCwgZnJhZ1N0cmluZywgdGhpcy5nbC5GUkFHTUVOVF9TSEFERVIpO1xuXG5cdFx0Ly8gSWYgRnJhZ21lbnQgc2hhZGVyIGZhaWxzIGxvYWQgYSBlbXB0eSBvbmUgdG8gc2lnbiB0aGUgZXJyb3Jcblx0XHRpZiAoIWZyYWdtZW50U2hhZGVyKSB7XG5cdFx0XHRmcmFnbWVudFNoYWRlciA9IGNyZWF0ZVNoYWRlcih0aGlzLmdsLCBcInZvaWQgbWFpbigpe1xcblxcdGdsX0ZyYWdDb2xvciA9IHZlYzQoMS4wKTtcXG59XCIsIHRoaXMuZ2wuRlJBR01FTlRfU0hBREVSKTtcblx0XHRcdHRoaXMuaXNWYWxpZCA9IGZhbHNlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmlzVmFsaWQgPSB0cnVlO1xuXHRcdH1cblxuXHRcdC8vIENyZWF0ZSBhbmQgdXNlIHByb2dyYW1cblx0XHRsZXQgcHJvZ3JhbSA9IGNyZWF0ZVByb2dyYW0odGhpcy5nbCwgW3ZlcnRleFNoYWRlciwgZnJhZ21lbnRTaGFkZXJdKTtcblx0XHR0aGlzLmdsLnVzZVByb2dyYW0ocHJvZ3JhbSk7XG5cblx0XHQvLyBEZWxldGUgc2hhZGVyc1xuXHRcdHRoaXMuZ2wuZGV0YWNoU2hhZGVyKHByb2dyYW0sIHZlcnRleFNoYWRlcik7XG5cdFx0dGhpcy5nbC5kZXRhY2hTaGFkZXIocHJvZ3JhbSwgZnJhZ21lbnRTaGFkZXIpO1xuXHRcdHRoaXMuZ2wuZGVsZXRlU2hhZGVyKHZlcnRleFNoYWRlcik7XG5cdFx0dGhpcy5nbC5kZWxldGVTaGFkZXIoZnJhZ21lbnRTaGFkZXIpO1xuXG5cdFx0dGhpcy5wcm9ncmFtID0gcHJvZ3JhbTtcblx0fVxuXG5cdHJlbmRlcih7IGZvcmNlUmVuZGVyLCBtb3VzZSB9KSB7XG5cblx0XHRpZiAoZm9yY2VSZW5kZXIgfHwgKHRoaXMuYW5pbWF0ZWQgJiYgaXNDYW52YXNWaXNpYmxlKHRoaXMuY2FudmFzKSkpIHtcblxuXHRcdFx0Ly8gc2V0IHRoZSB0aW1lIHVuaWZvcm1cblx0XHRcdGxldCB0aW1lRnJhbWUgPSBEYXRlLm5vdygpO1xuXHRcdFx0bGV0IHRpbWUgPSAodGltZUZyYW1lLXRoaXMudGltZUxvYWQpIC8gMTAwMC4wO1xuXHRcdFx0bGV0IHRpbWVMb2NhdGlvbiA9IHRoaXMuZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKHRoaXMucHJvZ3JhbSwgXCJ1X3RpbWVcIik7XG5cdFx0XHR0aGlzLmdsLnVuaWZvcm0xZih0aW1lTG9jYXRpb24sIHRpbWUpO1xuXG5cdFx0XHQvLyBzZXQgdGhlIG1vdXNlIHVuaWZvcm1cblx0XHRcdGxldCByZWN0ID0gdGhpcy5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0XHRpZiAobW91c2UgJiZcblx0XHRcdFx0bW91c2UueCA+PSByZWN0LmxlZnQgJiYgXG5cdFx0XHRcdG1vdXNlLnggPD0gcmVjdC5yaWdodCAmJiBcblx0XHRcdFx0bW91c2UueSA+PSByZWN0LnRvcCAmJlxuXHRcdFx0XHRtb3VzZS55IDw9IHJlY3QuYm90dG9tKSB7XG5cblx0XHRcdFx0bGV0IG1vdXNlTG9jYXRpb24gPSB0aGlzLmdsLmdldFVuaWZvcm1Mb2NhdGlvbih0aGlzLnByb2dyYW0sIFwidV9tb3VzZVwiKTtcblx0XHRcdFx0dGhpcy5nbC51bmlmb3JtMmYobW91c2VMb2NhdGlvbixtb3VzZS54LXJlY3QubGVmdCx0aGlzLmNhbnZhcy5oZWlnaHQtKG1vdXNlLnktcmVjdC50b3ApKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gc2V0IHRoZSByZXNvbHV0aW9uIHVuaWZvcm1cblx0XHRcdGxldCByZXNvbHV0aW9uTG9jYXRpb24gPSB0aGlzLmdsLmdldFVuaWZvcm1Mb2NhdGlvbih0aGlzLnByb2dyYW0sIFwidV9yZXNvbHV0aW9uXCIpO1xuXHRcdFx0dGhpcy5nbC51bmlmb3JtMmYocmVzb2x1dGlvbkxvY2F0aW9uLCB0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0KTtcblxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnRleHR1cmVzLmxlbmd0aDsgKytpKXtcblxuXHRcdFx0XHR0aGlzLmdsLnVuaWZvcm0xaSggdGhpcy5nbC5nZXRVbmlmb3JtTG9jYXRpb24oIHRoaXMucHJvZ3JhbSwgXCJ1X3RleFwiK2kpLCBpKTtcblx0XHRcdFx0dGhpcy5nbC51bmlmb3JtMmYoIHRoaXMuZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKCB0aGlzLnByb2dyYW0sIFwidV90ZXhcIitpK1wiUmVzb2x1dGlvblwiKSwgXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCB0aGlzLnRleHR1cmVzW2ldLmltYWdlLndpZHRoLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQgdGhpcy50ZXh0dXJlc1tpXS5pbWFnZS5oZWlnaHQpO1xuXG5cdFx0XHRcdHRoaXMuZ2wuYWN0aXZlVGV4dHVyZSh0aGlzLmdsLlRFWFRVUkUwK2kpO1xuXHRcdFx0XHR0aGlzLmdsLmJpbmRUZXh0dXJlKHRoaXMuZ2wuVEVYVFVSRV8yRCwgdGhpcy50ZXh0dXJlc1tpXSk7XG5cdFx0XHRcdFxuXHRcdFx0fVxuXG5cdFx0XHQvLyBEcmF3IHRoZSByZWN0YW5nbGUuXG5cdFx0XHR0aGlzLmdsLmRyYXdBcnJheXModGhpcy5nbC5UUklBTkdMRVMsIDAsIDYpO1xuXHRcdFx0Ly8gY29uc29sZS5sb2coXCJSZW5kZXIgXCIgKyB0aW1lKTtcblx0XHR9XG5cdH1cblxuXHR2ZXJzaW9uKCkge1xuXHRcdHJldHVybiBcIjAuMC4xXCI7XG5cdH1cbn07XG5cbndpbmRvdy5HbHNsQ2FudmFzID0gR2xzbENhbnZhczsiLCJ2YXIgbGFzdEVycm9yID0gXCJcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGxvYWRUZXh0dXJlKF9nbCwgX3RleHR1cmUpIHtcblx0X2dsLmJpbmRUZXh0dXJlKF9nbC5URVhUVVJFXzJELCBfdGV4dHVyZSk7XG5cdF9nbC5waXhlbFN0b3JlaShfZ2wuVU5QQUNLX0ZMSVBfWV9XRUJHTCwgdHJ1ZSk7XG5cdF9nbC50ZXhJbWFnZTJEKF9nbC5URVhUVVJFXzJELCAwLCBfZ2wuUkdCQSwgX2dsLlJHQkEsIF9nbC5VTlNJR05FRF9CWVRFLCBfdGV4dHVyZS5pbWFnZSk7XG5cdGlmIChpc1Bvd2VyT2YyKF90ZXh0dXJlLmltYWdlLndpZHRoKSAmJiBpc1Bvd2VyT2YyKF90ZXh0dXJlLmltYWdlLmhlaWdodCkgKSB7XG5cdFx0X2dsLmdlbmVyYXRlTWlwbWFwKF9nbC5URVhUVVJFXzJEKTtcblx0XHRfZ2wudGV4UGFyYW1ldGVyaShfZ2wuVEVYVFVSRV8yRCwgX2dsLlRFWFRVUkVfTUFHX0ZJTFRFUiwgX2dsLkxJTkVBUik7XG5cdFx0X2dsLnRleFBhcmFtZXRlcmkoX2dsLlRFWFRVUkVfMkQsIF9nbC5URVhUVVJFX01JTl9GSUxURVIsIF9nbC5MSU5FQVJfTUlQTUFQX0xJTkVBUik7XG5cdH0gZWxzZSB7XG5cdFx0X2dsLnRleFBhcmFtZXRlcmkoX2dsLlRFWFRVUkVfMkQsIF9nbC5URVhUVVJFX1dSQVBfUywgX2dsLkNMQU1QX1RPX0VER0UpO1xuXHRcdF9nbC50ZXhQYXJhbWV0ZXJpKF9nbC5URVhUVVJFXzJELCBfZ2wuVEVYVFVSRV9XUkFQX1QsIF9nbC5DTEFNUF9UT19FREdFKTtcblx0XHRfZ2wudGV4UGFyYW1ldGVyaShfZ2wuVEVYVFVSRV8yRCwgX2dsLlRFWFRVUkVfTUlOX0ZJTFRFUiwgX2dsLkxJTkVBUik7XG5cdH1cblx0X2dsLmJpbmRUZXh0dXJlKF9nbC5URVhUVVJFXzJELCBudWxsKTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIHRoZSBIVExNIGZvciBhIGZhaWx1cmUgbWVzc2FnZVxuICogQHBhcmFtIHtzdHJpbmd9IGNhbnZhc0NvbnRhaW5lcklkIGlkIG9mIGNvbnRhaW5lciBvZiB0aFxuICogICAgICAgIGNhbnZhcy5cbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIGh0bWwuXG4gKi9cbnZhciBtYWtlRmFpbEhUTUwgPSBmdW5jdGlvbihtc2cpIHtcbiBcdHJldHVybiAnJyArXG5cdFx0Jzx0YWJsZSBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6ICM4Q0U7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCU7XCI+PHRyPicgK1xuXHRcdCc8dGQgYWxpZ249XCJjZW50ZXJcIj4nICtcblx0XHQnPGRpdiBzdHlsZT1cImRpc3BsYXk6IHRhYmxlLWNlbGw7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7XCI+JyArXG5cdFx0JzxkaXYgc3R5bGU9XCJcIj4nICsgbXNnICsgJzwvZGl2PicgK1xuXHRcdCc8L2Rpdj4nICtcblx0XHQnPC90ZD48L3RyPjwvdGFibGU+Jztcbn07XG5cbi8qKlxuICogTWVzYXNnZSBmb3IgZ2V0dGluZyBhIHdlYmdsIGJyb3dzZXJcbiAqIEB0eXBlIHtzdHJpbmd9XG4gKi9cbnZhciBHRVRfQV9XRUJHTF9CUk9XU0VSID0gJycgK1xuXHQnVGhpcyBwYWdlIHJlcXVpcmVzIGEgYnJvd3NlciB0aGF0IHN1cHBvcnRzIFdlYkdMLjxici8+JyArXG5cdCc8YSBocmVmPVwiaHR0cDovL2dldC53ZWJnbC5vcmdcIj5DbGljayBoZXJlIHRvIHVwZ3JhZGUgeW91ciBicm93c2VyLjwvYT4nO1xuXG4vKipcbiAqIE1lc2FzZ2UgZm9yIG5lZWQgYmV0dGVyIGhhcmR3YXJlXG4gKiBAdHlwZSB7c3RyaW5nfVxuICovXG52YXIgT1RIRVJfUFJPQkxFTSA9ICcnICtcblx0XCJJdCBkb2Vzbid0IGFwcGVhciB5b3VyIGNvbXB1dGVyIGNhbiBzdXBwb3J0IFdlYkdMLjxici8+XCIgK1xuXHQnPGEgaHJlZj1cImh0dHA6Ly9nZXQud2ViZ2wub3JnL3Ryb3VibGVzaG9vdGluZy9cIj5DbGljayBoZXJlIGZvciBtb3JlIGluZm9ybWF0aW9uLjwvYT4nO1xuXG4vKipcbiAqIENyZWF0ZXMgYSB3ZWJnbCBjb250ZXh0LiBJZiBjcmVhdGlvbiBmYWlscyBpdCB3aWxsXG4gKiBjaGFuZ2UgdGhlIGNvbnRlbnRzIG9mIHRoZSBjb250YWluZXIgb2YgdGhlIDxjYW52YXM+XG4gKiB0YWcgdG8gYW4gZXJyb3IgbWVzc2FnZSB3aXRoIHRoZSBjb3JyZWN0IGxpbmtzIGZvciBXZWJHTC5cbiAqIEBwYXJhbSB7RWxlbWVudH0gY2FudmFzLiBUaGUgY2FudmFzIGVsZW1lbnQgdG8gY3JlYXRlIGFcbiAqICAgICBjb250ZXh0IGZyb20uXG4gKiBAcGFyYW0ge1dlYkdMQ29udGV4dENyZWF0aW9uQXR0aXJidXRlc30gb3B0X2F0dHJpYnMgQW55XG4gKiAgICAgY3JlYXRpb24gYXR0cmlidXRlcyB5b3Ugd2FudCB0byBwYXNzIGluLlxuICogQHJldHVybiB7V2ViR0xSZW5kZXJpbmdDb250ZXh0fSBUaGUgY3JlYXRlZCBjb250ZXh0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0dXBXZWJHTCAoX2NhbnZhcywgX29wdF9hdHRyaWJzKSB7XG5cblx0ZnVuY3Rpb24gc2hvd0xpbmsoc3RyKSB7XG5cdFx0dmFyIGNvbnRhaW5lciA9IF9jYW52YXMucGFyZW50Tm9kZTtcblx0XHRpZiAoY29udGFpbmVyKSB7XG5cdFx0ICBjb250YWluZXIuaW5uZXJIVE1MID0gbWFrZUZhaWxIVE1MKHN0cik7XG5cdFx0fVxuXHR9O1xuXG5cdGlmICghd2luZG93LldlYkdMUmVuZGVyaW5nQ29udGV4dCkge1xuXHRcdHNob3dMaW5rKEdFVF9BX1dFQkdMX0JST1dTRVIpO1xuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0dmFyIGNvbnRleHQgPSBjcmVhdGUzRENvbnRleHQoX2NhbnZhcywgX29wdF9hdHRyaWJzKTtcblx0aWYgKCFjb250ZXh0KSB7XG5cdFx0c2hvd0xpbmsoT1RIRVJfUFJPQkxFTSk7XG5cdH1cblx0Y29udGV4dC5nZXRFeHRlbnNpb24oJ09FU19zdGFuZGFyZF9kZXJpdmF0aXZlcycpO1xuXHRyZXR1cm4gY29udGV4dDtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIHdlYmdsIGNvbnRleHQuXG4gKiBAcGFyYW0geyFDYW52YXN9IGNhbnZhcyBUaGUgY2FudmFzIHRhZyB0byBnZXQgY29udGV4dFxuICogICAgIGZyb20uIElmIG9uZSBpcyBub3QgcGFzc2VkIGluIG9uZSB3aWxsIGJlIGNyZWF0ZWQuXG4gKiBAcmV0dXJuIHshV2ViR0xDb250ZXh0fSBUaGUgY3JlYXRlZCBjb250ZXh0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlM0RDb250ZXh0KF9jYW52YXMsIF9vcHRfYXR0cmlicykge1xuXHR2YXIgbmFtZXMgPSBbXCJ3ZWJnbFwiLCBcImV4cGVyaW1lbnRhbC13ZWJnbFwiXTtcblx0dmFyIGNvbnRleHQgPSBudWxsO1xuXHRmb3IgKHZhciBpaSA9IDA7IGlpIDwgbmFtZXMubGVuZ3RoOyArK2lpKSB7XG5cdFx0dHJ5IHtcblx0ICBcdFx0Y29udGV4dCA9IF9jYW52YXMuZ2V0Q29udGV4dChuYW1lc1tpaV0sIF9vcHRfYXR0cmlicyk7XG5cdFx0fSBjYXRjaChlKSB7fVxuXHRcdFx0aWYgKGNvbnRleHQpIHtcblx0ICBcdFx0XHRicmVhaztcblx0XHR9XG5cdH1cblx0cmV0dXJuIGNvbnRleHQ7XG59XG5cbi8qXG4gKlx0Q3JlYXRlIGEgVmVydGV4IG9mIGEgc3BlY2lmaWMgdHlwZSAoZ2wuVkVSVEVYX1NIQURFUi8pXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTaGFkZXIoX2dsLCBfc291cmNlLCBfdHlwZSkge1xuXHR2YXIgc2hhZGVyID0gX2dsLmNyZWF0ZVNoYWRlciggX3R5cGUgKTtcblx0X2dsLnNoYWRlclNvdXJjZShzaGFkZXIsIF9zb3VyY2UpO1xuXHRfZ2wuY29tcGlsZVNoYWRlcihzaGFkZXIpO1xuXG5cdHZhciBjb21waWxlZCA9IF9nbC5nZXRTaGFkZXJQYXJhbWV0ZXIoc2hhZGVyLCBfZ2wuQ09NUElMRV9TVEFUVVMpO1xuXHRcblx0aWYgKCFjb21waWxlZCkge1xuXHRcdC8vIFNvbWV0aGluZyB3ZW50IHdyb25nIGR1cmluZyBjb21waWxhdGlvbjsgZ2V0IHRoZSBlcnJvclxuXHRcdGxhc3RFcnJvciA9IF9nbC5nZXRTaGFkZXJJbmZvTG9nKHNoYWRlcik7XG5cdFx0Y29uc29sZS5lcnJvcihcIioqKiBFcnJvciBjb21waWxpbmcgc2hhZGVyICdcIiArIHNoYWRlciArIFwiJzpcIiArIGxhc3RFcnJvcik7XG5cdFx0X2dsLmRlbGV0ZVNoYWRlcihzaGFkZXIpO1xuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0cmV0dXJuIHNoYWRlcjtcbn1cblxuLyoqXG4gKiBMb2FkcyBhIHNoYWRlci5cbiAqIEBwYXJhbSB7IVdlYkdMQ29udGV4dH0gZ2wgVGhlIFdlYkdMQ29udGV4dCB0byB1c2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gc2hhZGVyU291cmNlIFRoZSBzaGFkZXIgc291cmNlLlxuICogQHBhcmFtIHtudW1iZXJ9IHNoYWRlclR5cGUgVGhlIHR5cGUgb2Ygc2hhZGVyLlxuICogQHBhcmFtIHtmdW5jdGlvbihzdHJpbmcpOiB2b2lkKSBvcHRfZXJyb3JDYWxsYmFjayBjYWxsYmFjayBmb3IgZXJyb3JzLlxuICogQHJldHVybiB7IVdlYkdMU2hhZGVyfSBUaGUgY3JlYXRlZCBzaGFkZXIuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQcm9ncmFtKGdsLCBzaGFkZXJzLCBvcHRfYXR0cmlicywgb3B0X2xvY2F0aW9ucykge1xuXHR2YXIgcHJvZ3JhbSA9IGdsLmNyZWF0ZVByb2dyYW0oKTtcblx0Zm9yICh2YXIgaWkgPSAwOyBpaSA8IHNoYWRlcnMubGVuZ3RoOyArK2lpKSB7XG5cdFx0Z2wuYXR0YWNoU2hhZGVyKHByb2dyYW0sIHNoYWRlcnNbaWldKTtcblx0fVxuXHRpZiAob3B0X2F0dHJpYnMpIHtcblx0XHRmb3IgKHZhciBpaSA9IDA7IGlpIDwgb3B0X2F0dHJpYnMubGVuZ3RoOyArK2lpKSB7XG5cdCAgXHRcdGdsLmJpbmRBdHRyaWJMb2NhdGlvbihcblx0XHQgIFx0cHJvZ3JhbSxcblx0XHQgIFx0b3B0X2xvY2F0aW9ucyA/IG9wdF9sb2NhdGlvbnNbaWldIDogaWksXG5cdFx0ICBcdG9wdF9hdHRyaWJzW2lpXSk7XG5cdFx0fVxuXHR9XG5cdGdsLmxpbmtQcm9ncmFtKHByb2dyYW0pO1xuXG5cdC8vIENoZWNrIHRoZSBsaW5rIHN0YXR1c1xuXHR2YXIgbGlua2VkID0gZ2wuZ2V0UHJvZ3JhbVBhcmFtZXRlcihwcm9ncmFtLCBnbC5MSU5LX1NUQVRVUyk7XG5cdGlmICghbGlua2VkKSB7XG5cdFx0Ly8gc29tZXRoaW5nIHdlbnQgd3Jvbmcgd2l0aCB0aGUgbGlua1xuXHRcdGxhc3RFcnJvciA9IGdsLmdldFByb2dyYW1JbmZvTG9nIChwcm9ncmFtKTtcblx0XHRjb25zb2xlLmxvZyhcIkVycm9yIGluIHByb2dyYW0gbGlua2luZzpcIiArIGxhc3RFcnJvcik7XG5cblx0XHRnbC5kZWxldGVQcm9ncmFtKHByb2dyYW0pO1xuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cdHJldHVybiBwcm9ncmFtO1xufTsiLCJleHBvcnQgZnVuY3Rpb24gaXNDYW52YXNWaXNpYmxlKF9jYW52YXMpe1xuXHRyZXR1cm5cdCgoX2NhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgKyBfY2FudmFzLmhlaWdodCkgPiAwKSAmJiBcblx0XHRcdChfY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCA8ICh3aW5kb3cuaW5uZXJIZWlnaHQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCkpO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGlzUG93ZXJPZjIodmFsdWUpIHtcbiAgcmV0dXJuICh2YWx1ZSAmICh2YWx1ZSAtIDEpKSA9PSAwO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIG5leHRIaWdoZXN0UG93ZXJPZlR3byh4KSB7XG4gICAgLS14O1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgMzI7IGkgPDw9IDEpIHtcbiAgICAgICAgeCA9IHggfCB4ID4+IGk7XG4gICAgfVxuICAgIHJldHVybiB4ICsgMTtcbn07XG5cbi8qXG4gKlx0RmV0Y2ggZm9yIGZpbGVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmZXRjaEhUVFAodXJsLCBtZXRob29kKXtcblx0dmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKSwgcmVzcG9uc2U7XG5cblx0cmVxdWVzdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdFx0aWYgKHJlcXVlc3QucmVhZHlTdGF0ZSA9PT0gNCAmJiByZXF1ZXN0LnN0YXR1cyA9PT0gMjAwKSB7XG5cdFx0XHRyZXNwb25zZSA9IHJlcXVlc3QucmVzcG9uc2VUZXh0O1xuXHRcdH1cblx0fVxuXHRyZXF1ZXN0Lm9wZW4obWV0aG9vZCA/IG1ldGhvb2QgOiAnR0VUJywgdXJsLCBmYWxzZSk7XG5cdHJlcXVlc3Qub3ZlcnJpZGVNaW1lVHlwZShcInRleHQvcGxhaW5cIik7XG5cdHJlcXVlc3Quc2VuZCgpO1xuXHRyZXR1cm4gcmVzcG9uc2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBGb3JtYXROdW1iZXJMZW5ndGgoX251bSwgX2xlbmd0aCkge1xuICAgIHZhciByID0gXCJcIiArIF9udW07XG4gICAgd2hpbGUgKHIubGVuZ3RoIDwgX2xlbmd0aCkge1xuICAgICAgICByID0gXCIwXCIgKyByO1xuICAgIH1cbiAgICByZXR1cm4gcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1vdXNlUG9zKF9jYW52YXMsIF9ldnQpIHtcblx0dmFyIHJlY3QgPSBfY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRyZXR1cm4ge1xuXHRcdHg6IF9ldnQuY2xpZW50WCAtIHJlY3QubGVmdCxcblx0XHR5OiBfZXZ0LmNsaWVudFkgLSByZWN0LnRvcFxuXHR9O1xufSJdfQ==
